syntax = "proto3";
import "google/protobuf/timestamp.proto";
package types;
option go_package = "github.com/okzmo/nyo/proto";

message WSMessage {
  oneof content {
    ChangeStatus user_change_status = 1;
    NewChatMessage new_chat_message = 2;
    EditChatMessage edit_chat_message = 3;
    DeleteChatMessage delete_chat_message = 4;
    StartChannel start_channel = 5;
    KillChannel kill_channel = 6;
  }
}

message ChangeStatus {
  string type = 1;
	User user = 2;
	string channel_id = 3;
	string server_id = 4;
	string status = 5;
  repeated string roles = 6;
}

message NewChatMessage {
  Message message = 1;
}

message EditChatMessage {
  Message message = 1;
}

message DeleteChatMessage {
  Message message = 1;
}

message StartChannel {
	Channel channel = 1;
}

message KillChannel {
	Channel channel = 1;
}

message Message {
	string id = 1;
	User author = 2;
	string server_id = 3;
	string channel_id = 4;
	bytes content = 5;
	bool everyone = 6;
	repeated string mentions_users= 7;
	repeated string mentions_channels = 8;
	bytes attachments = 9;
	google.protobuf.Timestamp created_at = 10;
	google.protobuf.Timestamp updated_at = 11;
}

message User {
  string id = 1;
  string username = 2;
  string display_name = 3;
  string avatar = 4;
  string banner = 5;
  bytes about_me = 6;
  int32 experience = 7;
  string main_color = 8;
  repeated UserLinksRow links = 9;
  repeated UserFactsRow facts = 10;
	google.protobuf.Timestamp created_at = 11;
	google.protobuf.Timestamp updated_at = 12;
}

message Channel {
	string id = 1;
	string server_id = 2;
  string category_id = 3;
	string name = 4;
	string description = 5;
	string type = 6;
	bool e2ee = 7;
	repeated string users = 8;
	repeated string roles = 9;
	bool active = 10;
  int32 position = 11;
}

message UserLinksRow {
  string id = 1;
  string label = 2;
  string url = 3;
}

message UserFactsRow {
  string id = 1;
  string label = 2;
  string value = 3;
}

message GetServerUsers {
  repeated string user_ids = 1;
}
